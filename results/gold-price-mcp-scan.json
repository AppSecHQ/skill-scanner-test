{
  "skill_name": "gold_price_mcp",
  "skill_path": "/workspace/skills/clawhub-gold-price-mcp",
  "skill_directory": "/workspace/skills/clawhub-gold-price-mcp",
  "is_safe": true,
  "max_severity": "MEDIUM",
  "findings_count": 2,
  "findings": [
    {
      "id": "TOOL_MISMATCH_NETWORK_7df9b75abd",
      "rule_id": "TOOL_ABUSE_UNDECLARED_NETWORK",
      "category": "unauthorized_tool_use",
      "severity": "MEDIUM",
      "title": "Undeclared network usage",
      "description": "Skill code uses network libraries but doesn't declare network requirement",
      "file_path": null,
      "line_number": null,
      "snippet": null,
      "remediation": "Declare network usage in compatibility field or remove network calls",
      "analyzer": "static",
      "metadata": {
        "meta_validated": true,
        "meta_confidence": "HIGH",
        "meta_confidence_reason": "The skill clearly makes network calls (httpx.AsyncClient.get), and the manifest is missing the allowed-tools field entirely.",
        "meta_exploitability": "N/A - This is a metadata issue, not an exploitable vulnerability",
        "meta_impact": "Low - Reduces transparency about skill capabilities but doesn't create a security risk"
      }
    },
    {
      "id": "llm_finding_gold_price_mcp_0",
      "rule_id": "LLM_DATA_EXFILTRATION",
      "category": "data_exfiltration",
      "severity": "MEDIUM",
      "title": "External API Dependency Without Validation or Provenance",
      "description": "The skill makes HTTP requests to an external third-party API (https://api.chnwt.dev/thai-gold-api/latest) without any validation of response integrity, HTTPS certificate pinning, or documented provenance. While the API appears to be for legitimate gold price data, there is no verification mechanism to ensure the data hasn't been tampered with or that the API endpoint remains trustworthy. An attacker who compromises the API domain or performs a man-in-the-middle attack could inject malicious data into the agent's context.",
      "file_path": "gold-price-mcp.py",
      "line_number": 17,
      "snippet": "API_URL = \"https://api.chnwt.dev/thai-gold-api/latest\"",
      "remediation": "1. Document the API provenance and ownership in the manifest. 2. Implement response validation (schema checking, signature verification if available). 3. Add error handling for unexpected response formats. 4. Consider adding rate limiting to prevent abuse. 5. Document the external dependency clearly in the description field.",
      "analyzer": "llm",
      "metadata": {
        "model": "claude-sonnet-4-5-20250929",
        "overall_assessment": "This skill is a relatively straightforward MCP (Model Context Protocol) service that fetches Thai gold prices from an external API. The code quality is reasonable with proper async/await patterns and error handling. However, there are MEDIUM severity concerns around the external API dependency lacking validation and provenance documentation. The skill makes network calls to a third-party domain without any integrity verification, which could be exploited if the API is compromised. LOW severity issues include missing manifest metadata (license, compatibility, allowed-tools) and hardcoded Python version requirements. The skill does NOT contain prompt injection, data exfiltration to attacker-controlled servers, credential theft, or command injection vulnerabilities. The external API call is for legitimate data retrieval, not malicious exfiltration. Overall, this skill appears to be a legitimate utility with some security hygiene improvements needed around dependency management and metadata documentation.",
        "primary_threats": [
          "External API Dependency Without Validation",
          "Missing Manifest Metadata",
          "Hardcoded Dependencies"
        ],
        "aitech": "AITech-8.2",
        "aitech_name": "Data Exfiltration / Exposure",
        "aisubtech": "AISubtech-8.2.3",
        "aisubtech_name": "Data Exfiltration via Agent Tooling",
        "scanner_category": "SECURITY VIOLATION",
        "meta_validated": true,
        "meta_confidence": "HIGH",
        "meta_confidence_reason": "LLM analyzer correctly identified that external API calls without validation pose a supply chain risk. The code does check status='success' but doesn't validate the actual data structure comprehensively.",
        "meta_exploitability": "Medium - Requires compromising the external API domain or MITM attack",
        "meta_impact": "Medium - Could inject malicious data into agent context, potentially leading to incorrect decisions based on manipulated gold prices"
      }
    }
  ],
  "scan_duration_seconds": 30.0244140625,
  "duration_ms": 30024,
  "analyzers_used": [
    "static_analyzer",
    "behavioral_analyzer",
    "llm_analyzer",
    "trigger_analyzer",
    "meta_analyzer"
  ],
  "timestamp": "2026-02-06T02:29:31.352404"
}