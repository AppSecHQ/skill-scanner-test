{
  "skill_name": "aws-agentic-ai",
  "skill_path": "/workspace/skills/zxkane-aws-skills/plugins/aws-agentic-ai/skills/aws-agentic-ai",
  "skill_directory": "/workspace/skills/zxkane-aws-skills/plugins/aws-agentic-ai/skills/aws-agentic-ai",
  "is_safe": true,
  "max_severity": "MEDIUM",
  "findings_count": 2,
  "findings": [
    {
      "id": "llm_finding_aws-agentic-ai_0",
      "rule_id": "LLM_DATA_EXFILTRATION",
      "category": "data_exfiltration",
      "severity": "MEDIUM",
      "title": "Hardcoded AWS Account ID Exposure in Deployment Script",
      "description": "The deploy-template.sh script retrieves and exports the AWS account ID (CDK_DEFAULT_ACCOUNT) which could be logged or exposed in error messages. While not a direct credential leak, account IDs are sensitive metadata that can aid attackers in reconnaissance and targeted attacks.",
      "file_path": "services/gateway/deploy-template.sh",
      "line_number": null,
      "snippet": "export CDK_DEFAULT_ACCOUNT=$(aws sts get-caller-identity --query Account --output text --profile ${AWS_PROFILE:-default})",
      "remediation": "Ensure account IDs are not logged in plain text. Consider using AWS CloudTrail for audit logging instead of exposing account metadata in scripts. Validate that error handling does not leak account information.",
      "analyzer": "llm",
      "metadata": {
        "model": "claude-sonnet-4-5-20250929",
        "overall_assessment": "The aws-agentic-ai skill is a comprehensive AWS Bedrock AgentCore management tool with SAFE overall security posture. The skill provides legitimate AWS infrastructure management capabilities through AWS CLI commands and MCP tools. All referenced documentation files are internal to the skill package (normal behavior). The bash scripts follow standard DevOps patterns for AWS deployment automation. The primary concerns are minor: potential account ID exposure in logs (MEDIUM), missing error handling that could cause availability issues (LOW), and missing optional metadata (LOW). No critical threats such as data exfiltration, prompt injection, or malicious code execution were detected. The skill correctly requires AWS MCP tools and includes proper dependency management (aws-mcp-setup). The allowed-tools configuration appropriately restricts operations to AWS CLI commands and MCP tools.",
        "primary_threats": [
          "Data Exposure (Account Metadata)",
          "Availability Risk (Error Handling)",
          "Documentation Gaps"
        ],
        "aitech": "AITech-8.2",
        "aitech_name": "Data Exfiltration / Exposure",
        "aisubtech": "AISubtech-8.2.3",
        "aisubtech_name": "Data Exfiltration via Agent Tooling",
        "scanner_category": "SECURITY VIOLATION",
        "meta_validated": true,
        "meta_confidence": "MEDIUM",
        "meta_confidence_reason": "AWS account IDs are not considered secrets by AWS (they appear in ARNs, resource IDs, etc.), but the LLM analyzer correctly identifies this as minor metadata exposure. Downgraded from MEDIUM to LOW severity as this is informational logging in a deployment script, not active exfiltration.",
        "meta_exploitability": "Low - Account IDs alone cannot be exploited without additional credentials",
        "meta_impact": "Low - Aids reconnaissance but does not directly enable attacks"
      }
    },
    {
      "id": "llm_finding_aws-agentic-ai_1",
      "rule_id": "LLM_RESOURCE_ABUSE",
      "category": "resource_abuse",
      "severity": "LOW",
      "title": "Missing Error Handling for AWS CLI Commands",
      "description": "Multiple bash scripts execute AWS CLI commands without comprehensive error handling beyond 'set -e'. If AWS CLI commands fail silently or return unexpected output, the scripts may continue execution in an inconsistent state, potentially causing resource exhaustion or deployment failures.",
      "file_path": "services/gateway/deploy-template.sh",
      "line_number": null,
      "snippet": "set -e is used but individual command failures may not be caught properly, especially in pipelines or subshells",
      "remediation": "Add explicit error checking after critical AWS CLI commands. Use '|| exit 1' for critical operations. Implement timeout controls for long-running operations. Add validation of command outputs before proceeding.",
      "analyzer": "llm",
      "metadata": {
        "model": "claude-sonnet-4-5-20250929",
        "overall_assessment": "The aws-agentic-ai skill is a comprehensive AWS Bedrock AgentCore management tool with SAFE overall security posture. The skill provides legitimate AWS infrastructure management capabilities through AWS CLI commands and MCP tools. All referenced documentation files are internal to the skill package (normal behavior). The bash scripts follow standard DevOps patterns for AWS deployment automation. The primary concerns are minor: potential account ID exposure in logs (MEDIUM), missing error handling that could cause availability issues (LOW), and missing optional metadata (LOW). No critical threats such as data exfiltration, prompt injection, or malicious code execution were detected. The skill correctly requires AWS MCP tools and includes proper dependency management (aws-mcp-setup). The allowed-tools configuration appropriately restricts operations to AWS CLI commands and MCP tools.",
        "primary_threats": [
          "Data Exposure (Account Metadata)",
          "Availability Risk (Error Handling)",
          "Documentation Gaps"
        ],
        "aitech": "AITech-13.3",
        "aitech_name": "Availability Disruption",
        "aisubtech": "AISubtech-13.3.2",
        "aisubtech_name": "Compute Exhaustion",
        "scanner_category": "RESOURCE ABUSE",
        "meta_validated": true,
        "meta_confidence": "MEDIUM",
        "meta_confidence_reason": "Standard DevOps practice issue. 'set -e' provides basic error handling but doesn't catch all failure modes (pipelines, command substitutions). This is a code quality issue, not a security vulnerability.",
        "meta_exploitability": "Low - Requires deployment script execution with specific failure conditions",
        "meta_impact": "Low - May cause deployment failures or inconsistent state, but no security breach"
      }
    }
  ],
  "scan_duration_seconds": 27.602562427520752,
  "duration_ms": 27602,
  "analyzers_used": [
    "static_analyzer",
    "behavioral_analyzer",
    "llm_analyzer",
    "trigger_analyzer",
    "meta_analyzer"
  ],
  "timestamp": "2026-02-06T06:30:52.355940"
}