# Agent Skill Security Scan Report

**Skill:** azure-monitor-query-py
**Directory:** /workspace/skills/microsoft-agent-skills/.github/skills/azure-monitor-query-py
**Status:** [OK] SAFE
**Max Severity:** MEDIUM
**Scan Duration:** 39.80s
**Timestamp:** 2026-02-05T15:37:22.725510

## Summary

- **Total Findings:** 3
- **Critical:** 0
- **High:** 0
- **Medium:** 2
- **Low:** 1
- **Info:** 0

## Findings

### MEDIUM Severity

#### [MEDIUM] Hardcoded Credential Environment Variable Pattern

**Severity:** MEDIUM
**Category:** data_exfiltration
**Rule ID:** LLM_DATA_EXFILTRATION
**Location:** SKILL.md

**Description:** The skill instructions demonstrate reading Azure credentials from environment variables (AZURE_LOG_ANALYTICS_WORKSPACE_ID, AZURE_METRICS_RESOURCE_URI) and using DefaultAzureCredential which may access sensitive credential stores (~/.azure, environment variables, managed identity tokens). While using DefaultAzureCredential is a legitimate Azure SDK pattern, the skill does not warn users about credential exposure risks or validate that credentials are properly scoped. If an agent executes this code in an environment with overly permissive credentials, it could access Azure resources beyond the intended scope.

#### [MEDIUM] Unbounded Query Execution Without Resource Limits

**Severity:** MEDIUM
**Category:** resource_abuse
**Rule ID:** LLM_RESOURCE_ABUSE
**Location:** SKILL.md

**Description:** The skill demonstrates querying Azure Monitor logs and metrics without any resource limits, timeouts, or result size constraints. The batch query example shows executing multiple queries without bounds checking. Large time ranges (e.g., timedelta(hours=24)) or complex Kusto queries could consume excessive API quota, cause long execution times, or return massive datasets that exhaust memory. There are no safeguards against runaway queries or cost controls.

### LOW Severity

#### [LOW] Kusto Query Injection Risk in User-Provided Queries

**Severity:** LOW
**Category:** command_injection
**Rule ID:** LLM_COMMAND_INJECTION
**Location:** SKILL.md

**Description:** The skill instructions show executing Kusto queries directly without demonstrating input validation or parameterization. If an agent constructs queries by concatenating user input into the query string, this could lead to Kusto query injection where malicious input modifies query logic. While the examples use hardcoded queries, the skill does not warn about this risk or show safe query construction patterns.

## Analyzers

The following analyzers were used:

- static_analyzer
- behavioral_analyzer
- llm_analyzer
- trigger_analyzer
- meta_analyzer
