{
  "skill_name": "video-agent",
  "skill_path": "/workspace/skills/clawhub-video-agent",
  "skill_directory": "/workspace/skills/clawhub-video-agent",
  "is_safe": true,
  "max_severity": "MEDIUM",
  "findings_count": 1,
  "findings": [
    {
      "id": "llm_finding_video-agent_0",
      "rule_id": "LLM_DATA_EXFILTRATION",
      "category": "data_exfiltration",
      "severity": "MEDIUM",
      "title": "API Key Required in Environment Variable",
      "description": "The skill requires HEYGEN_API_KEY to be set as an environment variable. While this is a standard practice for API authentication, users should be aware that the scripts will have access to this credential. The skill does not implement any additional security measures like key validation, rotation reminders, or scope limitations.",
      "file_path": "SKILL.md",
      "line_number": null,
      "snippet": "export HEYGEN_API_KEY=\"your-api-key\"",
      "remediation": "Document security best practices: (1) Use API keys with minimal required permissions, (2) Rotate keys regularly, (3) Never commit keys to version control, (4) Consider using a secrets manager for production use, (5) Validate key format before making API calls to prevent accidental exposure in error messages.",
      "analyzer": "llm",
      "metadata": {
        "model": "claude-sonnet-4-5-20250929",
        "overall_assessment": "This HeyGen Video Agent skill is GENERALLY SAFE with minor security considerations. The skill provides a straightforward wrapper around HeyGen's Video Agent API for generating AI avatar videos. The code uses standard Python libraries (urllib, json, pathlib) without dangerous operations like eval/exec. Network calls are limited to the legitimate HeyGen API endpoints (api.heygen.com). The skill requires an API key via environment variable, which is standard practice but requires user awareness. File operations are limited to creating output directories and downloading videos to user-specified locations. The referenced prompt-optimizer.md file is an internal resource bundled with the skill (normal behavior) and contains legitimate guidance for writing effective video generation prompts. No prompt injection, data exfiltration, command injection, or social engineering threats were detected. The main considerations are proper API key management and the standard risks of executing Python scripts that make network calls and write files.",
        "primary_threats": [],
        "aitech": "AITech-8.2",
        "aitech_name": "Data Exfiltration / Exposure",
        "aisubtech": "AISubtech-8.2.3",
        "aisubtech_name": "Data Exfiltration via Agent Tooling",
        "scanner_category": "SECURITY VIOLATION",
        "meta_validated": true,
        "meta_confidence": "HIGH",
        "meta_confidence_reason": "LLM analyzer correctly identified this as standard API authentication practice. The code only uses the key for legitimate HeyGen API endpoints (api.heygen.com). No exfiltration to other domains detected.",
        "meta_exploitability": "None - This is legitimate functionality",
        "meta_impact": "None - Standard API authentication pattern"
      }
    }
  ],
  "scan_duration_seconds": 18.605933666229248,
  "duration_ms": 18605,
  "analyzers_used": [
    "static_analyzer",
    "llm_analyzer",
    "meta_analyzer"
  ],
  "timestamp": "2026-02-07T21:29:46.683297"
}